import{getContext as e,store as s}from"@wordpress/interactivity";const{state:t,actions:o}=s("pw-newsletter-form",{state:{token:"",submitted:!1,message:"",showMessage:!1},actions:{hideMessage:()=>{setTimeout(()=>{t.showMessage=!1},5e3)},getToken:()=>{fetch("/wp-json/pw_newsletter_form/getToken").then(e=>e.json()).then(e=>{t.token=e.token}).catch(e=>{console.error("Error fetching token:",e)})},submitForm:s=>{const r=e();s.preventDefault();const a=s.target,n=new FormData(a);var m;""!==a.email.value&&(m=a.email.value,/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(m))&&(t.submitted=!0,fetch("/wp-json/pw_newsletter_form/action",{method:"POST",body:n}).then(e=>e.json()).then(e=>{const{data:s}=e;return 200!==s.status?(t.message=r.error_status_message||e.message||"An error occurred",t.showMessage=!0,t.submitted=!1,void o.hideMessage()):s.error?(t.message=r.error_message||e.error,t.showMessage=!0,t.submitted=!1,void o.hideMessage()):(t.message=r.success_message||e.message||"Success!",t.showMessage=!0,a.reset(),t.submitted=!1,void o.hideMessage())}).catch(e=>{console.error("Error submitting form:",e)}))}}});