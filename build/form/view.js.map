{"version":3,"file":"form/view.js","mappings":"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","sources":["webpack://pw-newsletter-form/external module \"@wordpress/interactivity\"","webpack://pw-newsletter-form/webpack/bootstrap","webpack://pw-newsletter-form/webpack/runtime/make namespace object","webpack://pw-newsletter-form/./src/form/view.ts"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { getContext, store, withScope } from '@wordpress/interactivity';\n\ninterface ContextType {\n  error_message: string;\n  success_message: string;\n  error_status_message: string;\n}\n\n\n/**\n * check email\n * @param {string} text\n * @returns boolean\n */\nconst isEmail = (text) => {\n  const re =\n    /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n  return re.test(text);\n};\n\n\nconst { state, actions } = store('pw-newsletter-form', {\n  state: {\n    token: '',\n    submitted: false,\n    message: '',\n    showMessage: false,\n  },\n  actions: {\n    hideMessage: () => {\n      setTimeout(() => {\n        state.showMessage = false;\n      }, 5000);\n    },\n    getToken: () => {\n      fetch(\"/wp-json/pw_newsletter_form/getToken\")\n        .then((res) => res.json())\n        .then((res) => {\n          state.token = res.token;\n        }).catch((err) => {\n          console.error('Error fetching token:', err);\n        });\n    },\n    submitForm: (event) => {\n      const ctx = getContext() as ContextType;\n      event.preventDefault();\n      const form = event.target;\n      const formData = new FormData(form);\n\n      if (form.email.value !== \"\" && isEmail(form.email.value)) {\n        state.submitted = true;\n\n        fetch(\"/wp-json/pw_newsletter_form/action\", {\n          method: 'POST',\n          body: formData,\n        })\n          .then((res) => res.json())\n          .then((res) => {\n            const { data } = res;\n\n            // error before action\n            if (data.status !== 200) {\n              state.message = ctx.error_status_message || res.message || 'An error occurred';\n              state.showMessage = true;\n              state.submitted = false;\n              actions.hideMessage();\n              return;\n            }\n\n            // error from brevo\n            if (data.error) {\n              state.message = ctx.error_message || res.error;\n              state.showMessage = true;\n              state.submitted = false;\n              actions.hideMessage();\n              return;\n            }\n\n            // success\n            state.message = ctx.success_message || res.message || 'Success!';\n            state.showMessage = true;\n            form.reset();\n            state.submitted = false;\n            actions.hideMessage();\n\n          }).catch((err) => {\n            console.error('Error submitting form:', err);\n          });\n      }\n    },\n  }\n});"],"names":["getContext","store","isEmail","text","re","test","state","actions","token","submitted","message","showMessage","hideMessage","setTimeout","getToken","fetch","then","res","json","catch","err","console","error","submitForm","event","ctx","preventDefault","form","target","formData","FormData","email","value","method","body","data","status","error_status_message","error_message","success_message","reset"],"sourceRoot":""}